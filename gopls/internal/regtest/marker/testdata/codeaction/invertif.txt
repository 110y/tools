This test exercises the 'invert if condition' code action.

-- p.go --
package invertif

import (
	"fmt"
	"os"
)

func Boolean() {
	b := true
	if b { //@codeactionedit("if b", "refactor.rewrite", boolean)
		fmt.Println("A")
	} else {
		fmt.Println("B")
	}
}

func BooleanFn() {
	if os.IsPathSeparator('X') { //@codeactionedit("if os.IsPathSeparator('X')", "refactor.rewrite", boolean_fn)
		fmt.Println("A")
	} else {
		fmt.Println("B")
	}
}

// Note that the comment here jumps to the wrong location.
func DontRemoveParens() {
	a := false
	b := true
	if !(a ||
		b) { //@codeactionedit("b", "refactor.rewrite", dont_remove_parens)
		fmt.Println("A")
	} else {
		fmt.Println("B")
	}
}

func ElseIf() {
	// No inversion expected when there's not else clause
	if len(os.Args) > 2 {
		fmt.Println("A")
	}

	// No inversion expected for else-if, that would become unreadable
	if len(os.Args) > 2 {
		fmt.Println("A")
	} else if os.Args[0] == "X" { //@codeactionedit(re"if os.Args.0. == .X.", "refactor.rewrite", else_if)
		fmt.Println("B")
	} else {
		fmt.Println("C")
	}
}

func GreaterThan() {
	if len(os.Args) > 2 { //@codeactionedit("i", "refactor.rewrite", greater_than)
		fmt.Println("A")
	} else {
		fmt.Println("B")
	}
}

func NotBoolean() {
	b := true
	if !b { //@codeactionedit("if !b", "refactor.rewrite", not_boolean)
		fmt.Println("A")
	} else {
		fmt.Println("B")
	}
}

func RemoveElse() {
	if true { //@codeactionedit("if true", "refactor.rewrite", remove_else)
		fmt.Println("A")
	} else {
		fmt.Println("B")
		return
	}

	fmt.Println("C")
}

func RemoveParens() {
	b := true
	if !(b) { //@codeactionedit("if", "refactor.rewrite", remove_parens)
		fmt.Println("A")
	} else {
		fmt.Println("B")
	}
}

func Semicolon() {
	if _, err := fmt.Println("x"); err != nil { //@codeactionedit("if", "refactor.rewrite", semicolon)
		fmt.Println("A")
	} else {
		fmt.Println("B")
	}
}

func SemicolonAnd() {
	if n, err := fmt.Println("x"); err != nil && n > 0 { //@codeactionedit("f", "refactor.rewrite", semicolon_and)
		fmt.Println("A")
	} else {
		fmt.Println("B")
	}
}

func SemicolonOr() {
	if n, err := fmt.Println("x"); err != nil || n < 5 { //@codeactionedit(re"if n, err := fmt.Println..x..; err != nil .. n < 5", "refactor.rewrite", semicolon_or)
		fmt.Println("A")
	} else {
		fmt.Println("B")
	}
}

-- @boolean/p.go --
--- before
+++ after
@@ -10,4 +10,4 @@
-	if b { //@codeactionedit("if b", "refactor.rewrite", boolean)
+	if !b {
+		fmt.Println("B")
+	} else { //@codeactionedit("if b", "refactor.rewrite", boolean)
-		fmt.Println("A")
-	} else {
-		fmt.Println("B")
+		fmt.Println("A")
-- @boolean_fn/p.go --
--- before
+++ after
@@ -18,4 +18,4 @@
-	if os.IsPathSeparator('X') { //@codeactionedit("if os.IsPathSeparator('X')", "refactor.rewrite", boolean_fn)
+	if !os.IsPathSeparator('X') {
+		fmt.Println("B")
+	} else { //@codeactionedit("if os.IsPathSeparator('X')", "refactor.rewrite", boolean_fn)
-		fmt.Println("A")
-	} else {
-		fmt.Println("B")
+		fmt.Println("A")
-- @dont_remove_parens/p.go --
--- before
+++ after
@@ -29,5 +29,5 @@
-	if !(a ||
+	if (a ||
-		b) { //@codeactionedit("b", "refactor.rewrite", dont_remove_parens)
+		b) {
+		fmt.Println("B")
+	} else { //@codeactionedit("b", "refactor.rewrite", dont_remove_parens)
-		fmt.Println("A")
-	} else {
-		fmt.Println("B")
+		fmt.Println("A")
-- @else_if/p.go --
--- before
+++ after
@@ -46,4 +46,4 @@
-	} else if os.Args[0] == "X" { //@codeactionedit(re"if os.Args.0. == .X.", "refactor.rewrite", else_if)
+	} else if os.Args[0] != "X" {
+		fmt.Println("C")
+	} else { //@codeactionedit(re"if os.Args.0. == .X.", "refactor.rewrite", else_if)
-		fmt.Println("B")
-	} else {
-		fmt.Println("C")
+		fmt.Println("B")
-- @greater_than/p.go --
--- before
+++ after
@@ -54,4 +54,4 @@
-	if len(os.Args) > 2 { //@codeactionedit("i", "refactor.rewrite", greater_than)
+	if len(os.Args) <= 2 {
+		fmt.Println("B")
+	} else { //@codeactionedit("i", "refactor.rewrite", greater_than)
-		fmt.Println("A")
-	} else {
-		fmt.Println("B")
+		fmt.Println("A")
-- @not_boolean/p.go --
--- before
+++ after
@@ -63,4 +63,4 @@
-	if !b { //@codeactionedit("if !b", "refactor.rewrite", not_boolean)
+	if b {
+		fmt.Println("B")
+	} else { //@codeactionedit("if !b", "refactor.rewrite", not_boolean)
-		fmt.Println("A")
-	} else {
-		fmt.Println("B")
+		fmt.Println("A")
-- @remove_else/p.go --
--- before
+++ after
@@ -71,6 +71,7 @@
-	if true { //@codeactionedit("if true", "refactor.rewrite", remove_else)
+	if false {
+		fmt.Println("B")
+		return
+	}
+
+	//@codeactionedit("if true", "refactor.rewrite", remove_else)
-		fmt.Println("A")
-	} else {
-		fmt.Println("B")
-		return
-	}
+	fmt.Println("A")
-- @remove_parens/p.go --
--- before
+++ after
@@ -83,4 +83,4 @@
-	if !(b) { //@codeactionedit("if", "refactor.rewrite", remove_parens)
+	if b {
+		fmt.Println("B")
+	} else { //@codeactionedit("if", "refactor.rewrite", remove_parens)
-		fmt.Println("A")
-	} else {
-		fmt.Println("B")
+		fmt.Println("A")
-- @semicolon/p.go --
--- before
+++ after
@@ -91,4 +91,4 @@
-	if _, err := fmt.Println("x"); err != nil { //@codeactionedit("if", "refactor.rewrite", semicolon)
+	if _, err := fmt.Println("x"); err == nil {
+		fmt.Println("B")
+	} else { //@codeactionedit("if", "refactor.rewrite", semicolon)
-		fmt.Println("A")
-	} else {
-		fmt.Println("B")
+		fmt.Println("A")
-- @semicolon_and/p.go --
--- before
+++ after
@@ -99,4 +99,4 @@
-	if n, err := fmt.Println("x"); err != nil && n > 0 { //@codeactionedit("f", "refactor.rewrite", semicolon_and)
+	if n, err := fmt.Println("x"); err == nil || n <= 0 {
+		fmt.Println("B")
+	} else { //@codeactionedit("f", "refactor.rewrite", semicolon_and)
-		fmt.Println("A")
-	} else {
-		fmt.Println("B")
+		fmt.Println("A")
-- @semicolon_or/p.go --
--- before
+++ after
@@ -107,4 +107,4 @@
-	if n, err := fmt.Println("x"); err != nil || n < 5 { //@codeactionedit(re"if n, err := fmt.Println..x..; err != nil .. n < 5", "refactor.rewrite", semicolon_or)
+	if n, err := fmt.Println("x"); err == nil && n >= 5 {
+		fmt.Println("B")
+	} else { //@codeactionedit(re"if n, err := fmt.Println..x..; err != nil .. n < 5", "refactor.rewrite", semicolon_or)
-		fmt.Println("A")
-	} else {
-		fmt.Println("B")
+		fmt.Println("A")
